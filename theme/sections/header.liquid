{% comment %}
  Premium Header - Ultra Mega Menu
  CloudyPrints Theme - Full Working Version
{% endcomment %}

<!-- Announcement Bar -->
{% if section.settings.show_announcement %}
<div class="announcement-bar">
  <div class="container">
    <div class="announcement-content">
      <div class="announcement-marquee">
        <span class="announcement-item">
          {% if section.settings.announcement_icon != blank %}
            <i class="{{ section.settings.announcement_icon }}"></i>
          {% endif %}
          {{ section.settings.announcement_text }}
          {% if section.settings.announcement_link != blank %}
            <a href="{{ section.settings.announcement_link }}">{{ section.settings.announcement_link_text }} →</a>
          {% endif %}
        </span>
      </div>
    </div>
  </div>
</div>
{% endif %}

<!-- Main Header -->
<header class="main-header {% if section.settings.sticky_header %}sticky-header{% endif %} header-layout-{{ section.settings.header_layout | default: 'default' }}" id="mainHeader">

  {% if section.settings.header_layout == 'stacked' %}
  <!-- ═══════════════════════════════════════════════════════════════════════
       STACKED LAYOUT (Mode 2): Top Row + Bottom Row
       ═══════════════════════════════════════════════════════════════════════ -->
  <div class="header-top-row">
    <div class="container">
      <div class="header-top-inner">
        <!-- Logo (Center) -->
        <a href="{{ routes.root_url }}" class="header-logo-stacked">
          {% if section.settings.logo %}
            <img src="{{ section.settings.logo | image_url: width: 200 }}"
                 alt="{{ shop.name }}"
                 width="200"
                 height="55"
                 class="logo-img">
          {% else %}
            <span class="logo-text">{{ shop.name }}</span>
          {% endif %}
        </a>

        <!-- Rich Search Bar -->
        <div class="header-search-stacked">
          <form action="{{ routes.search_url }}" method="get" class="stacked-search-form">
            <div class="stacked-search-wrapper">
              <i class="fa-solid fa-magnifying-glass stacked-search-icon"></i>
              <input type="text"
                     name="q"
                     placeholder="{{ section.settings.search_placeholder | default: 'Search products...' }}"
                     class="stacked-search-input"
                     autocomplete="off">
              <button type="submit" class="stacked-search-btn">
                Search
              </button>
            </div>
          </form>
        </div>

        <!-- Actions (Right) -->
        <div class="header-actions-stacked">
          <!-- Mobile Toggle for Stacked - Moved to top row -->
          <button class="mobile-toggle mobile-toggle-stacked" id="mobileToggleStacked" aria-label="Menu">
            <span class="toggle-bar"></span>
            <span class="toggle-bar"></span>
            <span class="toggle-bar"></span>
          </button>
          
          {% if section.settings.show_account %}
          <a href="{% if customer %}{{ routes.account_url }}{% else %}{{ routes.account_login_url }}{% endif %}"
             class="stacked-action-btn"
             aria-label="Account">
            <i class="fa-regular fa-user"></i>
            <span class="stacked-action-label">Account</span>
          </a>
          {% endif %}

          {% if section.settings.show_wishlist %}
          <a href="/pages/wishlist" class="stacked-action-btn" aria-label="Wishlist">
            <i class="fa-regular fa-heart"></i>
            <span class="stacked-action-label">Wishlist</span>
            <span class="stacked-action-badge wishlist-count">0</span>
          </a>
          {% endif %}

          <a href="{{ routes.cart_url }}" class="stacked-action-btn cart-stacked" aria-label="Cart" data-cart-trigger>
            <i class="fa-solid fa-bag-shopping"></i>
            <span class="stacked-action-label">Cart</span>
            <span class="stacked-action-badge cart-count">{{ cart.item_count }}</span>
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Bottom Row: Navigation -->
  <div class="header-bottom-row">
    <div class="container">
      <nav class="header-nav-stacked" id="headerNavStacked">
        <ul class="nav-menu nav-menu-stacked">
          {% if section.settings.menu != blank and linklists[section.settings.menu] %}
          {% for link in linklists[section.settings.menu].links %}
            {% assign has_mega = false %}
            {% assign mega_block = nil %}
            {% for block in section.blocks %}
              {% if block.type == 'mega_menu' %}
                {% assign block_title = block.settings.menu_title | downcase | strip %}
                {% assign link_title = link.title | downcase | strip %}
                {% if block_title == link_title %}
                  {% assign has_mega = true %}
                  {% assign mega_block = block %}
                  {% break %}
                {% endif %}
              {% endif %}
            {% endfor %}

            <li class="nav-item {% if link.links.size > 0 or has_mega %}has-mega{% endif %}" data-nav-item="{{ link.title | handleize }}">
              <a href="{{ link.url }}" class="nav-link {% if link.active %}active{% endif %}">
                <span>{{ link.title }}</span>
                {% if link.links.size > 0 or has_mega %}
                  <i class="fa-solid fa-chevron-down nav-arrow"></i>
                {% endif %}
              </a>

              {% if link.links.size > 0 or has_mega %}
              <div class="mega-dropdown" data-mega="{{ link.title | handleize }}">
                <div class="mega-container">
                  <div class="mega-inner">
                    <div class="mega-gradient-bar"></div>
                    <div class="mega-tabbed-layout">
                      <div class="mega-tabs-col">
                        <div class="mega-col-header">
                          <div class="mega-icon-wrap">
                            <i class="fa-solid fa-layer-group"></i>
                          </div>
                          <span>{{ link.title }}</span>
                        </div>
                        {%- comment %} Check if ANY submenu has products assigned {% endcomment -%}
                        {%- assign has_any_products = false -%}
                        {%- for childlink in link.links -%}
                          {%- for block in section.blocks -%}
                            {%- if block.type == 'submenu_item' -%}
                              {%- assign block_parent = block.settings.parent_menu | downcase | strip -%}
                              {%- assign block_submenu = block.settings.submenu_title | downcase | strip -%}
                              {%- assign link_parent = link.title | downcase | strip -%}
                              {%- assign child_title = childlink.title | downcase | strip -%}
                              {%- if block_parent == link_parent and block_submenu == child_title -%}
                                {%- if block.settings.product_1 != blank or block.settings.product_2 != blank or block.settings.product_3 != blank -%}
                                  {%- assign has_any_products = true -%}
                                  {%- break -%}
                                {%- endif -%}
                              {%- endif -%}
                            {%- endif -%}
                          {%- endfor -%}
                          {%- if has_any_products -%}{%- break -%}{%- endif -%}
                        {%- endfor -%}
                        
                        <ul class="mega-tabs-list">
                          {% for childlink in link.links %}
                            <a href="{{ childlink.url }}" class="mega-tab-item {% if forloop.first %}active{% endif %}"
                                data-tab="{{ childlink.title | handleize }}"
                                data-parent="{{ link.title | handleize }}"
                                {% if has_any_products %}data-has-products="true"{% endif %}>
                              <span class="mega-tab-dot"></span>
                              <span class="mega-tab-text">{{ childlink.title }}</span>
                              {% if has_any_products %}
                                <i class="fa-solid fa-chevron-right mega-tab-arrow"></i>
                              {% endif %}
                            </a>
                          {% endfor %}
                          {% if link.links.size == 0 %}
                            <a href="{{ link.url }}" class="mega-tab-item active"
                                data-tab="all-{{ link.title | handleize }}"
                                data-parent="{{ link.title | handleize }}">
                              <span class="mega-tab-dot"></span>
                              <span class="mega-tab-text">View All</span>
                            </a>
                          {% endif %}
                        </ul>
                      </div>
                      {% if has_any_products %}
                      <div class="mega-products-col">
                        {% for childlink in link.links %}
                          {% comment %} Find matching submenu_item block {% endcomment %}
                          {% assign submenu_block = nil %}
                          {% for block in section.blocks %}
                            {% if block.type == 'submenu_item' %}
                              {% assign block_parent = block.settings.parent_menu | downcase | strip %}
                              {% assign block_submenu = block.settings.submenu_title | downcase | strip %}
                              {% assign link_parent = link.title | downcase | strip %}
                              {% assign child_title = childlink.title | downcase | strip %}
                              {% if block_parent == link_parent and block_submenu == child_title %}
                                {% assign submenu_block = block %}
                                {% break %}
                              {% endif %}
                            {% endif %}
                          {% endfor %}
                          
                          <div class="mega-products-panel {% if forloop.first %}active{% endif %}"
                               data-panel="{{ childlink.title | handleize }}"
                               data-parent="{{ link.title | handleize }}">
                            <div class="mega-panel-header">
                              <h4>{{ childlink.title }}</h4>
                              <a href="{{ childlink.url }}" class="mega-view-all">
                                View All <i class="fa-solid fa-arrow-right"></i>
                              </a>
                            </div>
                            
                            {% if submenu_block %}
                              <div class="mega-products-grid-3">
                                {% if submenu_block.settings.product_1 != blank %}
                                  {% assign p1 = submenu_block.settings.product_1 %}
                                  <a href="{{ p1.url }}" class="mega-product-card-sm">
                                    <div class="mega-product-img-sm">
                                      {% if p1.featured_image %}
                                        <img src="{{ p1.featured_image | image_url: width: 150 }}" alt="{{ p1.title }}" width="150" height="150" loading="lazy">
                                      {% else %}
                                        <div class="mega-placeholder-sm"><i class="fa-solid fa-image"></i></div>
                                      {% endif %}
                                    </div>
                                    <span class="mega-product-name-sm">{{ p1.title | truncate: 18 }}</span>
                                    <span class="mega-product-price-sm">{{ p1.price | money }}</span>
                                  </a>
                                {% endif %}
                                {% if submenu_block.settings.product_2 != blank %}
                                  {% assign p2 = submenu_block.settings.product_2 %}
                                  <a href="{{ p2.url }}" class="mega-product-card-sm">
                                    <div class="mega-product-img-sm">
                                      {% if p2.featured_image %}
                                        <img src="{{ p2.featured_image | image_url: width: 150 }}" alt="{{ p2.title }}" width="150" height="150" loading="lazy">
                                      {% else %}
                                        <div class="mega-placeholder-sm"><i class="fa-solid fa-image"></i></div>
                                      {% endif %}
                                    </div>
                                    <span class="mega-product-name-sm">{{ p2.title | truncate: 18 }}</span>
                                    <span class="mega-product-price-sm">{{ p2.price | money }}</span>
                                  </a>
                                {% endif %}
                                {% if submenu_block.settings.product_3 != blank %}
                                  {% assign p3 = submenu_block.settings.product_3 %}
                                  <a href="{{ p3.url }}" class="mega-product-card-sm">
                                    <div class="mega-product-img-sm">
                                      {% if p3.featured_image %}
                                        <img src="{{ p3.featured_image | image_url: width: 150 }}" alt="{{ p3.title }}" width="150" height="150" loading="lazy">
                                      {% else %}
                                        <div class="mega-placeholder-sm"><i class="fa-solid fa-image"></i></div>
                                      {% endif %}
                                    </div>
                                    <span class="mega-product-name-sm">{{ p3.title | truncate: 18 }}</span>
                                    <span class="mega-product-price-sm">{{ p3.price | money }}</span>
                                  </a>
                                {% endif %}
                              </div>
                            {% else %}
                              <div class="mega-products-grid-3">
                                <div class="mega-no-products">
                                  <i class="fa-solid fa-box-open"></i>
                                  <span>No products assigned</span>
                                </div>
                              </div>
                            {% endif %}
                          </div>
                        {% endfor %}
                      </div>
                      {% endif %}
                    </div>
                  </div>
                </div>
              </div>
              {% endif %}
            </li>
          {% endfor %}
          {% endif %}
        </ul>
      </nav>
    </div>
  </div>
  {% else %}
  <!-- ═══════════════════════════════════════════════════════════════════════
       DEFAULT LAYOUT (Mode 1): Single Row
       ═══════════════════════════════════════════════════════════════════════ -->
  <div class="container">
    <div class="header-inner">
      
      <!-- Logo -->
      <a href="{{ routes.root_url }}" class="header-logo">
        {% if section.settings.logo %}
          <img src="{{ section.settings.logo | image_url: width: 180 }}" 
               alt="{{ shop.name }}" 
               width="180" 
               height="50"
               class="logo-img">
        {% else %}
          <span class="logo-text">{{ shop.name }}</span>
        {% endif %}
      </a>
      
      <!-- Desktop Navigation -->
      <nav class="header-nav" id="headerNav">
        <ul class="nav-menu">
          {% if section.settings.menu != blank and linklists[section.settings.menu] %}
          {% for link in linklists[section.settings.menu].links %}
            {% assign has_mega = false %}
            {% assign mega_block = nil %}
            {% for block in section.blocks %}
              {% if block.type == 'mega_menu' %}
                {% assign block_title = block.settings.menu_title | downcase | strip %}
                {% assign link_title = link.title | downcase | strip %}
                {% if block_title == link_title %}
                  {% assign has_mega = true %}
                  {% assign mega_block = block %}
                  {% break %}
                {% endif %}
              {% endif %}
            {% endfor %}
            
            <li class="nav-item {% if link.links.size > 0 or has_mega %}has-mega{% endif %}" data-nav-item="{{ link.title | handleize }}">
              <a href="{{ link.url }}" class="nav-link {% if link.active %}active{% endif %}">
                <span>{{ link.title }}</span>
                {% if link.links.size > 0 or has_mega %}
                  <i class="fa-solid fa-chevron-down nav-arrow"></i>
                {% endif %}
              </a>
              
              {% if link.links.size > 0 or has_mega %}
              <div class="mega-dropdown" data-mega="{{ link.title | handleize }}">
                <div class="mega-container">
                  <div class="mega-inner">
                    <!-- Animated Gradient Top -->
                    <div class="mega-gradient-bar"></div>
                    
                    <!-- Tabbed Mega Menu Layout -->
                    <div class="mega-tabbed-layout">
                      <!-- Left: Submenu Tabs -->
                      <div class="mega-tabs-col">
                        <div class="mega-col-header">
                          <div class="mega-icon-wrap">
                            <i class="fa-solid fa-layer-group"></i>
                          </div>
                          <span>{{ link.title }}</span>
                        </div>
                        {%- comment %} Check if ANY submenu has products assigned {% endcomment -%}
                        {%- assign has_any_products = false -%}
                        {%- for childlink in link.links -%}
                          {%- for block in section.blocks -%}
                            {%- if block.type == 'submenu_item' -%}
                              {%- assign block_parent = block.settings.parent_menu | downcase | strip -%}
                              {%- assign block_submenu = block.settings.submenu_title | downcase | strip -%}
                              {%- assign link_parent = link.title | downcase | strip -%}
                              {%- assign child_title = childlink.title | downcase | strip -%}
                              {%- if block_parent == link_parent and block_submenu == child_title -%}
                                {%- if block.settings.product_1 != blank or block.settings.product_2 != blank or block.settings.product_3 != blank -%}
                                  {%- assign has_any_products = true -%}
                                  {%- break -%}
                                {%- endif -%}
                              {%- endif -%}
                            {%- endif -%}
                          {%- endfor -%}
                          {%- if has_any_products -%}{%- break -%}{%- endif -%}
                        {%- endfor -%}
                        
                        <ul class="mega-tabs-list">
                          {% for childlink in link.links %}
                            <a href="{{ childlink.url }}" class="mega-tab-item {% if forloop.first %}active{% endif %}" 
                                data-tab="{{ childlink.title | handleize }}"
                                data-parent="{{ link.title | handleize }}"
                                {% if has_any_products %}data-has-products="true"{% endif %}>
                              <span class="mega-tab-dot"></span>
                              <span class="mega-tab-text">{{ childlink.title }}</span>
                              {% if has_any_products %}
                                <i class="fa-solid fa-chevron-right mega-tab-arrow"></i>
                              {% endif %}
                            </a>
                          {% endfor %}
                          {% if link.links.size == 0 %}
                            <a href="{{ link.url }}" class="mega-tab-item active" 
                                data-tab="all-{{ link.title | handleize }}"
                                data-parent="{{ link.title | handleize }}">
                              <span class="mega-tab-dot"></span>
                              <span class="mega-tab-text">View All</span>
                            </a>
                          {% endif %}
                        </ul>
                      </div>
                      
                      {% if has_any_products %}
                      <!-- Center: Products Panel -->
                      <div class="mega-products-col">
                        {% for childlink in link.links %}
                          {% comment %} Find matching submenu_item block {% endcomment %}
                          {% assign submenu_block = nil %}
                          {% for block in section.blocks %}
                            {% if block.type == 'submenu_item' %}
                              {% assign block_parent = block.settings.parent_menu | downcase | strip %}
                              {% assign block_submenu = block.settings.submenu_title | downcase | strip %}
                              {% assign link_parent = link.title | downcase | strip %}
                              {% assign child_title = childlink.title | downcase | strip %}
                              {% if block_parent == link_parent and block_submenu == child_title %}
                                {% assign submenu_block = block %}
                                {% break %}
                              {% endif %}
                            {% endif %}
                          {% endfor %}
                          
                          <div class="mega-products-panel {% if forloop.first %}active{% endif %}" 
                               data-panel="{{ childlink.title | handleize }}"
                               data-parent="{{ link.title | handleize }}">
                            <div class="mega-panel-header">
                              <h4>{{ childlink.title }}</h4>
                              <a href="{{ childlink.url }}" class="mega-view-all">
                                View All <i class="fa-solid fa-arrow-right"></i>
                              </a>
                            </div>
                            
                            {% if submenu_block %}
                              <div class="mega-products-grid-3">
                                {% if submenu_block.settings.product_1 != blank %}
                                  {% assign p1 = submenu_block.settings.product_1 %}
                                  <a href="{{ p1.url }}" class="mega-product-card-sm">
                                    <div class="mega-product-img-sm">
                                      {% if p1.featured_image %}
                                        <img src="{{ p1.featured_image | image_url: width: 150 }}" alt="{{ p1.title }}" width="150" height="150" loading="lazy">
                                      {% else %}
                                        <div class="mega-placeholder-sm"><i class="fa-solid fa-image"></i></div>
                                      {% endif %}
                                    </div>
                                    <span class="mega-product-name-sm">{{ p1.title | truncate: 18 }}</span>
                                    <span class="mega-product-price-sm">{{ p1.price | money }}</span>
                                  </a>
                                {% endif %}
                                {% if submenu_block.settings.product_2 != blank %}
                                  {% assign p2 = submenu_block.settings.product_2 %}
                                  <a href="{{ p2.url }}" class="mega-product-card-sm">
                                    <div class="mega-product-img-sm">
                                      {% if p2.featured_image %}
                                        <img src="{{ p2.featured_image | image_url: width: 150 }}" alt="{{ p2.title }}" width="150" height="150" loading="lazy">
                                      {% else %}
                                        <div class="mega-placeholder-sm"><i class="fa-solid fa-image"></i></div>
                                      {% endif %}
                                    </div>
                                    <span class="mega-product-name-sm">{{ p2.title | truncate: 18 }}</span>
                                    <span class="mega-product-price-sm">{{ p2.price | money }}</span>
                                  </a>
                                {% endif %}
                                {% if submenu_block.settings.product_3 != blank %}
                                  {% assign p3 = submenu_block.settings.product_3 %}
                                  <a href="{{ p3.url }}" class="mega-product-card-sm">
                                    <div class="mega-product-img-sm">
                                      {% if p3.featured_image %}
                                        <img src="{{ p3.featured_image | image_url: width: 150 }}" alt="{{ p3.title }}" width="150" height="150" loading="lazy">
                                      {% else %}
                                        <div class="mega-placeholder-sm"><i class="fa-solid fa-image"></i></div>
                                      {% endif %}
                                    </div>
                                    <span class="mega-product-name-sm">{{ p3.title | truncate: 18 }}</span>
                                    <span class="mega-product-price-sm">{{ p3.price | money }}</span>
                                  </a>
                                {% endif %}
                                {% if submenu_block.settings.product_4 != blank %}
                                  {% assign p4 = submenu_block.settings.product_4 %}
                                  <a href="{{ p4.url }}" class="mega-product-card-sm">
                                    <div class="mega-product-img-sm">
                                      {% if p4.featured_image %}
                                        <img src="{{ p4.featured_image | image_url: width: 150 }}" alt="{{ p4.title }}" width="150" height="150" loading="lazy">
                                      {% else %}
                                        <div class="mega-placeholder-sm"><i class="fa-solid fa-image"></i></div>
                                      {% endif %}
                                    </div>
                                    <span class="mega-product-name-sm">{{ p4.title | truncate: 18 }}</span>
                                    <span class="mega-product-price-sm">{{ p4.price | money }}</span>
                                  </a>
                                {% endif %}
                                {% if submenu_block.settings.product_5 != blank %}
                                  {% assign p5 = submenu_block.settings.product_5 %}
                                  <a href="{{ p5.url }}" class="mega-product-card-sm">
                                    <div class="mega-product-img-sm">
                                      {% if p5.featured_image %}
                                        <img src="{{ p5.featured_image | image_url: width: 150 }}" alt="{{ p5.title }}" width="150" height="150" loading="lazy">
                                      {% else %}
                                        <div class="mega-placeholder-sm"><i class="fa-solid fa-image"></i></div>
                                      {% endif %}
                                    </div>
                                    <span class="mega-product-name-sm">{{ p5.title | truncate: 18 }}</span>
                                    <span class="mega-product-price-sm">{{ p5.price | money }}</span>
                                  </a>
                                {% endif %}
                              </div>
                            {% else %}
                              <div class="mega-empty-panel">
                                <i class="fa-solid fa-box-open"></i>
                                <p>No products assigned</p>
                                <span>Add via Customizer → Submenu Products</span>
                              </div>
                            {% endif %}
                          </div>
                        {% endfor %}
                        
                        {% if link.links.size == 0 %}
                          <div class="mega-products-panel active" 
                               data-panel="all-{{ link.title | handleize }}"
                               data-parent="{{ link.title | handleize }}">
                            <div class="mega-panel-header">
                              <h4>{{ link.title }}</h4>
                              <a href="{{ link.url }}" class="mega-view-all">
                                View All <i class="fa-solid fa-arrow-right"></i>
                              </a>
                            </div>
                            <div class="mega-empty-panel">
                              <i class="fa-solid fa-layer-group"></i>
                              <p>Explore {{ link.title }}</p>
                            </div>
                          </div>
                        {% endif %}
                      </div>
                      {% endif %}
                      
                      <!-- Right: Promo Banner -->
                      {% if has_mega and mega_block %}
                      <div class="mega-promo-col">
                        {% if mega_block.settings.promo_image != blank %}
                        <a href="{{ mega_block.settings.promo_link | default: '#' }}" class="mega-promo-card-vertical">
                          <div class="mega-promo-badge-top">{{ mega_block.settings.promo_badge | default: 'NEW' }}</div>
                          <img src="{{ mega_block.settings.promo_image | image_url: width: 200 }}" alt="{{ mega_block.settings.promo_title }}" width="200" height="200" loading="lazy">
                          <div class="mega-promo-card-text">
                            <span class="mega-promo-card-title">{{ mega_block.settings.promo_title | default: 'New Arrivals' }}</span>
                            <span class="mega-promo-card-cta">Shop Now <i class="fa-solid fa-arrow-right"></i></span>
                          </div>
                        </a>
                        {% else %}
                        <div class="mega-promo-placeholder">
                          <i class="fa-solid fa-image"></i>
                          <span>Add promo image</span>
                        </div>
                        {% endif %}
                      </div>
                      {% endif %}
                    </div>
                  </div>
                </div>
              </div>
              {% endif %}
            </li>
          {% endfor %}
          {% endif %}
        </ul>
      </nav>
      
      <!-- Header Actions -->
      <div class="header-actions">
        <!-- Search -->
        <button class="action-btn search-trigger" id="searchTrigger" aria-label="Search">
          <i class="fa-solid fa-magnifying-glass"></i>
        </button>
        
        <!-- Account -->
        {% if section.settings.show_account %}
        <a href="{% if customer %}{{ routes.account_url }}{% else %}{{ routes.account_login_url }}{% endif %}" 
           class="action-btn account-btn" 
           aria-label="Account">
          <i class="fa-regular fa-user"></i>
        </a>
        {% endif %}
        
        <!-- Wishlist -->
        {% if section.settings.show_wishlist %}
        <a href="/pages/wishlist" class="action-btn wishlist-btn" aria-label="Wishlist">
          <i class="fa-regular fa-heart"></i>
          <span class="action-badge wishlist-count">0</span>
        </a>
        {% endif %}
        
        <!-- Cart -->
        <a href="{{ routes.cart_url }}" class="action-btn cart-btn" aria-label="Cart" data-cart-trigger>
          <i class="fa-solid fa-bag-shopping"></i>
          <span class="action-badge cart-count">{{ cart.item_count }}</span>
        </a>
        
        <!-- Mobile Menu Toggle -->
        <button class="mobile-toggle" id="mobileToggle" aria-label="Menu">
          <span class="toggle-bar"></span>
          <span class="toggle-bar"></span>
          <span class="toggle-bar"></span>
        </button>
      </div>
    </div>
  </div>
  
  <!-- Search Modal -->
  <div class="search-modal" id="searchModal">
    <div class="search-modal-inner">
      <form action="{{ routes.search_url }}" method="get" class="search-form">
        <div class="search-input-wrapper">
          <i class="fa-solid fa-magnifying-glass"></i>
          <input type="text" 
                 name="q" 
                 placeholder="Search for products..." 
                 class="search-input"
                 autocomplete="off"
                 id="searchInput">
          <button type="button" class="search-close" id="searchClose">
            <i class="fa-solid fa-xmark"></i>
          </button>
        </div>
        <div class="search-suggestions">
          <span class="suggestions-title">Popular Searches</span>
          <div class="suggestions-tags">
            <a href="{{ routes.search_url }}?q=dtf" class="suggestion-tag">DTF Transfers</a>
            <a href="{{ routes.search_url }}?q=gang+sheet" class="suggestion-tag">Gang Sheets</a>
            <a href="{{ routes.search_url }}?q=uv" class="suggestion-tag">UV DTF</a>
            <a href="{{ routes.search_url }}?q=custom" class="suggestion-tag">Custom Prints</a>
          </div>
        </div>
      </form>
    </div>
  </div>
  {% endif %}
</header>

<!-- Mobile Menu - Full Featured -->
<div class="mobile-menu" id="mobileMenu">
  <div class="mobile-menu-header">
    <a href="{{ routes.root_url }}" class="mobile-logo">
      {% if section.settings.logo %}
        <img src="{{ section.settings.logo | image_url: width: 140 }}" alt="{{ shop.name }}" width="140" height="40" loading="lazy">
      {% else %}
        <span>{{ shop.name }}</span>
      {% endif %}
    </a>
    <button class="mobile-close" id="mobileClose">
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  
  <div class="mobile-menu-body">
    <ul class="mobile-nav">
      {% for link in linklists[section.settings.menu].links %}
        {% assign has_children = false %}
        {% if link.links.size > 0 %}
          {% assign has_children = true %}
        {% endif %}
        
        {% comment %} Check if this menu item has a mega menu block {% endcomment %}
        {% assign mobile_mega_block = nil %}
        {% for block in section.blocks %}
          {% if block.type == 'mega_menu' %}
            {% assign block_title = block.settings.menu_title | downcase | strip %}
            {% assign link_title = link.title | downcase | strip %}
            {% if block_title == link_title %}
              {% assign mobile_mega_block = block %}
              {% assign has_children = true %}
              {% break %}
            {% endif %}
          {% endif %}
        {% endfor %}
        
        <li class="mobile-nav-item {% if has_children %}has-children{% endif %}">
          <div class="mobile-nav-row">
            <a href="{{ link.url }}" class="mobile-nav-link">
              <span>{{ link.title }}</span>
            </a>
            {% if has_children %}
              <button class="mobile-toggle-child" aria-label="Toggle submenu">
                <i class="fa-solid fa-plus"></i>
              </button>
            {% endif %}
          </div>
          
          {% if has_children %}
            <div class="mobile-subnav">
              {% comment %} Regular child links {% endcomment %}
              {% for childlink in link.links %}
                <a href="{{ childlink.url }}" class="mobile-subnav-link">
                  <span class="mobile-subnav-dot"></span>
                  {{ childlink.title }}
                </a>
              {% endfor %}
              
              {% comment %} Featured products from mega block {% endcomment %}
              {% if mobile_mega_block %}
                {% if mobile_mega_block.settings.featured_product_1 != blank or mobile_mega_block.settings.featured_product_2 != blank %}
                  <div class="mobile-featured-section">
                    <span class="mobile-featured-title">
                      <i class="fa-solid fa-star"></i>
                      {{ mobile_mega_block.settings.featured_title | default: 'Featured' }}
                    </span>
                    <div class="mobile-featured-products">
                      {% if mobile_mega_block.settings.featured_product_1 != blank %}
                        {% assign mfp1 = mobile_mega_block.settings.featured_product_1 %}
                        <a href="{{ mfp1.url }}" class="mobile-featured-product">
                          {% if mfp1.featured_image %}
                            <img src="{{ mfp1.featured_image | image_url: width: 80 }}" alt="{{ mfp1.title }}" width="80" height="80" loading="lazy">
                          {% endif %}
                          <div class="mobile-featured-info">
                            <span class="mobile-featured-name">{{ mfp1.title | truncate: 20 }}</span>
                            <span class="mobile-featured-price">{{ mfp1.price | money }}</span>
                          </div>
                        </a>
                      {% endif %}
                      {% if mobile_mega_block.settings.featured_product_2 != blank %}
                        {% assign mfp2 = mobile_mega_block.settings.featured_product_2 %}
                        <a href="{{ mfp2.url }}" class="mobile-featured-product">
                          {% if mfp2.featured_image %}
                            <img src="{{ mfp2.featured_image | image_url: width: 80 }}" alt="{{ mfp2.title }}" width="80" height="80" loading="lazy">
                          {% endif %}
                          <div class="mobile-featured-info">
                            <span class="mobile-featured-name">{{ mfp2.title | truncate: 20 }}</span>
                            <span class="mobile-featured-price">{{ mfp2.price | money }}</span>
                          </div>
                        </a>
                      {% endif %}
                    </div>
                  </div>
                {% endif %}
                
                {% if mobile_mega_block.settings.promo_image != blank %}
                  <a href="{{ mobile_mega_block.settings.promo_link | default: '#' }}" class="mobile-promo-banner">
                    <img src="{{ mobile_mega_block.settings.promo_image | image_url: width: 400 }}" alt="{{ mobile_mega_block.settings.promo_title }}" width="400" height="200" loading="lazy">
                    <div class="mobile-promo-overlay">
                      <span class="mobile-promo-badge">{{ mobile_mega_block.settings.promo_badge | default: 'NEW' }}</span>
                      <span class="mobile-promo-title">{{ mobile_mega_block.settings.promo_title | default: 'Shop Now' }}</span>
                    </div>
                  </a>
                {% endif %}
              {% endif %}
            </div>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  </div>
  
  <div class="mobile-menu-footer">
    <div class="mobile-actions">
      <a href="{% if customer %}{{ routes.account_url }}{% else %}{{ routes.account_login_url }}{% endif %}" class="mobile-action">
        <i class="fa-regular fa-user"></i>
        <span>{% if customer %}Account{% else %}Login{% endif %}</span>
      </a>
      <a href="/pages/wishlist" class="mobile-action">
        <i class="fa-regular fa-heart"></i>
        <span>Wishlist</span>
      </a>
      <a href="{{ routes.cart_url }}" class="mobile-action" data-cart-trigger>
        <i class="fa-solid fa-bag-shopping"></i>
        <span>Cart ({{ cart.item_count }})</span>
      </a>
    </div>
    
    {% if section.settings.show_social_mobile %}
    <div class="mobile-social">
      {% if section.settings.facebook %}<a href="{{ section.settings.facebook }}"><i class="fa-brands fa-facebook-f"></i></a>{% endif %}
      {% if section.settings.instagram %}<a href="{{ section.settings.instagram }}"><i class="fa-brands fa-instagram"></i></a>{% endif %}
      {% if section.settings.twitter %}<a href="{{ section.settings.twitter }}"><i class="fa-brands fa-x-twitter"></i></a>{% endif %}
      {% if section.settings.tiktok %}<a href="{{ section.settings.tiktok }}"><i class="fa-brands fa-tiktok"></i></a>{% endif %}
    </div>
    {% endif %}
  </div>
</div>
<div class="mobile-overlay" id="mobileOverlay"></div>

<style>
/* ============================================
   PREMIUM HEADER - ULTRA MEGA MENU
   ============================================ */

:root {
  --header-gradient-1: #667eea;
  --header-gradient-2: #764ba2;
  --header-gradient-3: #f093fb;
  --header-text: #1a1a2e;
  --header-text-light: #6c757d;
  --header-bg: #ffffff;
  --header-border: rgba(102, 126, 234, 0.1);
}

/* Announcement Bar */
.announcement-bar {
  background: linear-gradient(135deg, var(--header-gradient-1) 0%, var(--header-gradient-2) 100%);
  padding: 10px 0;
  position: relative;
  overflow: hidden;
}

.announcement-content {
  text-align: center;
}

.announcement-item {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  color: #fff;
  font-size: 0.85rem;
  font-weight: 500;
}

.announcement-item i {
  font-size: 1rem;
}

.announcement-item a {
  color: #fff;
  font-weight: 600;
  text-decoration: none;
  margin-left: 8px;
  transition: opacity 0.3s ease;
}

.announcement-item a:hover {
  opacity: 0.8;
}

/* Main Header */
.main-header {
  background: var(--header-bg);
  box-shadow: 0 2px 20px rgba(0, 0, 0, 0.06);
  position: relative;
  z-index: 1000;
  transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
}

.main-header.sticky-header {
  position: sticky;
  top: 0;
}

.main-header.scrolled {
  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
}

.main-header .container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 24px;
}

.header-inner {
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 80px;
  gap: 40px;
}

/* Logo */
.header-logo {
  flex-shrink: 0;
  text-decoration: none;
}

.logo-img {
  height: 45px;
  width: auto;
  object-fit: contain;
}

.logo-text {
  font-size: 1.75rem;
  font-weight: 800;
  background: linear-gradient(135deg, var(--header-gradient-1) 0%, var(--header-gradient-2) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  letter-spacing: -0.02em;
}

/* Navigation */
.header-nav {
  flex: 1;
  display: flex;
  justify-content: center;
}

.nav-menu {
  display: flex;
  align-items: center;
  gap: 8px;
  list-style: none;
  margin: 0;
  padding: 0;
}

.nav-item {
  position: relative;
}

.nav-link {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 12px 18px;
  color: var(--header-text);
  font-size: 0.9rem;
  font-weight: 600;
  text-decoration: none;
  border-radius: 12px;
  transition: all 0.3s ease;
  cursor: pointer;
}

.nav-link .nav-arrow {
  font-size: 0.6rem;
  transition: transform 0.3s ease;
}

.nav-link:hover,
.nav-link.active {
  color: var(--header-gradient-1);
  background: rgba(102, 126, 234, 0.08);
}

.nav-item.has-mega:hover .nav-link .nav-arrow,
.nav-item.mega-active .nav-link .nav-arrow {
  transform: rotate(180deg);
}

/* ============================================
   MEGA DROPDOWN - PREMIUM ULTRA DESIGN
   ============================================ */
.mega-dropdown {
  position: absolute;
  top: 100%;
  left: 0;
  right: auto;
  padding-top: 15px;
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
  transition: all 0.35s cubic-bezier(0.23, 1, 0.32, 1);
}

/* Prevent mega menu from going off-screen */
.nav-item:first-child .mega-dropdown {
  left: 0;
  right: auto;
}

.nav-item:last-child .mega-dropdown,
.nav-item:nth-last-child(2) .mega-dropdown {
  left: auto;
  right: 0;
}

/* Show mega menu on hover (desktop with mouse) OR when mega-active class is set */
@media (hover: hover) and (pointer: fine) {
  .nav-item.has-mega:hover .mega-dropdown {
    opacity: 1;
    visibility: visible;
    pointer-events: auto;
  }
}

/* Always show when mega-active class is present (touch devices, tablets) */
.nav-item.mega-active .mega-dropdown {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
}

.mega-container {
  position: relative;
}

.mega-inner {
  background: linear-gradient(165deg, #ffffff 0%, #fafbfc 100%);
  border-radius: 5px;
  box-shadow: 
    0 30px 90px rgba(102, 126, 234, 0.15),
    0 15px 40px rgba(0, 0, 0, 0.08),
    0 0 0 1px rgba(102, 126, 234, 0.08);
  display: flex;
  gap: 0;
  /* FLUID: min 320px, ideal 650px, max 95vw */
  min-width: min(320px, 95vw);
  max-width: min(900px, 95vw);
  overflow-x: auto;
  overflow-y: visible;
  position: relative;
  padding: 5px;
}

/* No products - tabs only */
.mega-tabbed-layout:not(:has(.mega-products-col)) {
  min-height: auto;
}

.mega-tabbed-layout:not(:has(.mega-products-col)) .mega-tabs-col {
  border-right: none;
}

/* Animated Gradient Bar */
.mega-gradient-bar {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, 
    var(--header-gradient-1), 
    var(--header-gradient-2), 
    var(--header-gradient-3), 
    var(--header-gradient-1));
  background-size: 300% 100%;
  animation: megaGradientFlow 4s linear infinite;
}

@keyframes megaGradientFlow {
  0% { background-position: 0% 50%; }
  100% { background-position: 300% 50%; }
}

/* Mega Columns */
.mega-column {
  padding: 28px;
  border-right: 1px solid var(--header-border);
}

.mega-column:last-child {
  border-right: none;
}

.mega-links-col {
  min-width: clamp(160px, 20vw, 220px);
  flex: 1;
}

.mega-featured-col {
  min-width: clamp(200px, 25vw, 260px);
  flex: 1.2;
  background: rgba(102, 126, 234, 0.02);
}

.mega-promo-col {
  width: clamp(160px, 18vw, 220px);
  flex-shrink: 0;
  padding: 20px;
  background: linear-gradient(180deg, rgba(102, 126, 234, 0.03) 0%, rgba(118, 75, 162, 0.05) 100%);
}

/* Column Headers */
.mega-col-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 20px;
  padding-bottom: 14px;
  border-bottom: 1px solid var(--header-border);
}

.mega-icon-wrap {
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.12) 0%, rgba(118, 75, 162, 0.12) 100%);
  border-radius: 10px;
  color: var(--header-gradient-1);
  font-size: 0.9rem;
}

.mega-icon-wrap.pulse {
  animation: iconPulse 2s ease-in-out infinite;
}

@keyframes iconPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

.mega-col-header span:last-child {
  font-size: 0.75rem;
  font-weight: 700;
  color: var(--header-gradient-1);
  text-transform: uppercase;
  letter-spacing: 0.1em;
}

/* Link List */
.mega-link-list {
  list-style: none;
  margin: 0;
  padding: 0;
}

.mega-link-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 14px;
  color: var(--header-text);
  font-size: 0.9rem;
  font-weight: 500;
  text-decoration: none;
  border-radius: 12px;
  transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
  margin-bottom: 2px;
}

.mega-dot {
  width: 6px;
  height: 6px;
  background: #d1d5db;
  border-radius: 50%;
  transition: all 0.3s ease;
  flex-shrink: 0;
}

.mega-link-text {
  flex: 1;
}

.mega-arrow {
  opacity: 0;
  transform: translateX(-8px);
  transition: all 0.3s ease;
  color: var(--header-gradient-1);
  font-size: 0.7rem;
}

.mega-link-item:hover {
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.06) 100%);
  color: var(--header-gradient-1);
  transform: translateX(6px);
}

.mega-link-item:hover .mega-dot {
  background: var(--header-gradient-1);
  box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
}

.mega-link-item:hover .mega-arrow {
  opacity: 1;
  transform: translateX(0);
}

/* Featured Products Grid */
.mega-products-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 14px;
}

/* ═══ NEW TABBED MEGA MENU STYLES ═══ */
.mega-tabbed-layout {
  display: flex;
  gap: 0;
  min-height: 320px;
  width: 100%;
}

.mega-tabs-col {
  width: clamp(160px, 22vw, 220px);
  flex-shrink: 0;
  border-right: 1px solid rgba(102, 126, 234, 0.1);
  padding: 5px;
}

.mega-tabs-list {
  list-style: none;
  margin: 0;
  padding: 0;
}

/* Tab item as link - clickable */
a.mega-tab-item {
  text-decoration: none;
  color: inherit;
}

.mega-tab-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 12px 16px;
  cursor: pointer;
  transition: all 0.25s ease;
  border-left: 3px solid transparent;
  position: relative;
}

.mega-tab-item:hover,
.mega-tab-item.active {
  background: linear-gradient(90deg, rgba(102, 126, 234, 0.08) 0%, transparent 100%);
  border-left-color: var(--header-gradient-1);
}

.mega-tab-item.active {
  background: linear-gradient(90deg, rgba(102, 126, 234, 0.12) 0%, transparent 100%);
}

.mega-tab-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: #d1d5db;
  transition: all 0.25s ease;
}

.mega-tab-item:hover .mega-tab-dot,
.mega-tab-item.active .mega-tab-dot {
  background: linear-gradient(135deg, var(--header-gradient-1), var(--header-gradient-2));
  box-shadow: 0 0 8px rgba(102, 126, 234, 0.5);
}

.mega-tab-text {
  flex: 1;
  font-size: 0.875rem;
  font-weight: 500;
  color: var(--header-text);
  transition: color 0.25s ease;
}

.mega-tab-item:hover .mega-tab-text,
.mega-tab-item.active .mega-tab-text {
  color: var(--header-gradient-1);
}

.mega-tab-arrow {
  font-size: 0.7rem;
  color: #d1d5db;
  transition: all 0.25s ease;
  opacity: 0;
  transform: translateX(-5px);
}

.mega-tab-item:hover .mega-tab-arrow,
.mega-tab-item.active .mega-tab-arrow {
  opacity: 1;
  transform: translateX(0);
  color: var(--header-gradient-1);
}

/* Products Panel */
.mega-products-col {
  flex: 1;
  padding: 5px 24px;
  position: relative;
  min-width: 0; /* Allow shrinking */
}

.mega-products-panel {
  display: none;
  animation: fadeInPanel 0.3s ease;
}

.mega-products-panel.active {
  display: block;
}

@keyframes fadeInPanel {
  from {
    opacity: 0;
    transform: translateX(10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.mega-panel-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 16px;
  padding-bottom: 10px;
  border-bottom: 1px solid rgba(102, 126, 234, 0.1);
}

.mega-panel-header h4 {
  margin: 0;
  font-size: 1rem;
  font-weight: 600;
  color: var(--header-text);
}

.mega-view-all {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 0.8rem;
  font-weight: 500;
  color: var(--header-gradient-1);
  text-decoration: none;
  transition: gap 0.25s ease;
}

.mega-view-all:hover {
  gap: 10px;
}

/* 3-Column Product Grid (smaller cards) */
.mega-products-grid-3 {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 14px;
}

.mega-product-card-sm {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 14px 10px;
  background: #fff;
  border-radius: 14px;
  text-decoration: none;
  border: 1px solid rgba(102, 126, 234, 0.08);
  transition: all 0.3s ease;
}

.mega-product-card-sm:hover {
  transform: translateY(-5px);
  box-shadow: 0 12px 30px rgba(102, 126, 234, 0.18);
  border-color: rgba(102, 126, 234, 0.2);
}

.mega-product-img-sm {
  width: 90px;
  height: 90px;
  border-radius: 12px;
  overflow: hidden;
  margin-bottom: 10px;
  background: linear-gradient(145deg, #f8f9fa, #e9ecef);
}

.mega-product-img-sm img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.4s ease;
}

.mega-product-card-sm:hover .mega-product-img-sm img {
  transform: scale(1.1);
}

.mega-placeholder-sm {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #d1d5db;
  font-size: 1.5rem;
}

.mega-product-name-sm {
  display: block;
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--header-text);
  text-align: center;
  margin-bottom: 6px;
  line-height: 1.3;
}

.mega-product-price-sm {
  font-size: 0.85rem;
  font-weight: 700;
  background: linear-gradient(135deg, var(--header-gradient-1), var(--header-gradient-2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* Right Promo Column */
.mega-promo-col {
  width: 180px;
  padding: 0 16px;
  border-left: 1px solid rgba(102, 126, 234, 0.1);
  display: flex;
  flex-direction: column;
  align-items: center;
}

.mega-promo-card-vertical {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-decoration: none;
  padding: 12px;
  background: linear-gradient(145deg, #f8f9fa, #fff);
  border-radius: 16px;
  border: 1px solid rgba(102, 126, 234, 0.08);
  transition: all 0.3s ease;
  position: relative;
  text-align: center;
}

.mega-promo-card-vertical:hover {
  transform: translateY(-4px);
  box-shadow: 0 12px 30px rgba(102, 126, 234, 0.15);
}

.mega-promo-badge-top {
  position: absolute;
  top: -8px;
  right: -8px;
  font-size: 0.65rem;
  font-weight: 700;
  color: #fff;
  background: linear-gradient(135deg, #ef4444, #f97316);
  padding: 4px 10px;
  border-radius: 6px;
  box-shadow: 0 3px 10px rgba(239, 68, 68, 0.35);
}

.mega-promo-card-vertical img {
  width: 120px;
  height: 120px;
  border-radius: 12px;
  object-fit: cover;
  margin-bottom: 10px;
}

.mega-promo-card-text {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.mega-promo-card-title {
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--header-text);
}

.mega-promo-card-cta {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--header-gradient-1);
}

.mega-promo-card-cta i {
  transition: transform 0.25s ease;
}

.mega-promo-card-vertical:hover .mega-promo-card-cta i {
  transform: translateX(4px);
}

.mega-promo-placeholder {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 30px 15px;
  text-align: center;
  color: #9ca3af;
  border: 2px dashed rgba(102, 126, 234, 0.15);
  border-radius: 16px;
  gap: 8px;
}

.mega-promo-placeholder i {
  font-size: 2rem;
  opacity: 0.4;
}

.mega-promo-placeholder span {
  font-size: 0.75rem;
}

/* Empty Panel */
.mega-empty-panel {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
  text-align: center;
  color: #9ca3af;
}

.mega-empty-panel i {
  font-size: 2.5rem;
  margin-bottom: 12px;
  opacity: 0.5;
}

.mega-empty-panel p {
  margin: 0 0 4px;
  font-weight: 600;
  color: #6b7280;
}

.mega-empty-panel span {
  font-size: 0.75rem;
}

/* ═══ MEGA MENU MOBILE RESPONSIVE ═══ */

/* Large Desktop - promo column visible */
@media (max-width: 1200px) {
  .mega-promo-col {
    display: none;
  }
  
  .mega-products-grid-3 {
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
  }
  
  .mega-product-img-sm {
    width: 80px;
    height: 80px;
  }
}

/* Medium screens - adjust grid */
@media (max-width: 992px) {
  .mega-inner {
    min-width: min(550px, 95vw);
  }
  
  .mega-products-grid-3 {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 1024px) {
  .mega-tabbed-layout {
    flex-direction: column;
    min-height: auto;
  }
  
  .mega-tabs-col {
    width: 100%;
    border-right: none;
    border-bottom: 1px solid rgba(102, 126, 234, 0.1);
    padding-bottom: 10px;
    margin-bottom: 16px;
  }
  
  .mega-tabs-list {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    padding: 0 10px;
  }
  
  .mega-tab-item {
    padding: 8px 14px;
    border-radius: 20px;
    border-left: none;
    background: rgba(102, 126, 234, 0.05);
  }
  
  .mega-tab-item:hover,
  .mega-tab-item.active {
    background: linear-gradient(135deg, var(--header-gradient-1), var(--header-gradient-2));
  }
  
  .mega-tab-item:hover .mega-tab-text,
  .mega-tab-item.active .mega-tab-text {
    color: #fff;
  }
  
  .mega-tab-item:hover .mega-tab-dot,
  .mega-tab-item.active .mega-tab-dot {
    background: #fff;
    box-shadow: none;
  }
  
  .mega-tab-arrow {
    display: none;
  }
  
  .mega-products-col {
    padding: 0 10px;
    min-width: auto;
  }
  
  .mega-products-grid-3 {
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
  }
  
  .mega-product-img-sm {
    width: 70px;
    height: 70px;
  }
}

@media (max-width: 768px) {
  .mega-products-grid-3 {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .mega-product-img-sm {
    width: 65px;
    height: 65px;
  }
}

@media (max-width: 480px) {
  .mega-tabs-list {
    flex-wrap: nowrap;
    overflow-x: auto;
    padding-bottom: 10px;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }
  
  .mega-tabs-list::-webkit-scrollbar {
    display: none;
  }
  
  .mega-tab-item {
    flex-shrink: 0;
  }
  
  .mega-products-grid-3 {
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
  }
  
  .mega-product-card-sm {
    padding: 10px 6px;
  }
  
  .mega-product-img-sm {
    width: 55px;
    height: 55px;
  }
  
  .mega-product-name-sm {
    font-size: 0.7rem;
  }
  
  .mega-product-price-sm {
    font-size: 0.75rem;
  }
}

.mega-product-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 16px 12px;
  background: #fff;
  border-radius: 16px;
  text-decoration: none;
  border: 1px solid rgba(102, 126, 234, 0.08);
  transition: all 0.35s cubic-bezier(0.23, 1, 0.32, 1);
  position: relative;
  overflow: hidden;
}

.mega-product-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 16px 40px rgba(102, 126, 234, 0.18);
  border-color: rgba(102, 126, 234, 0.25);
}

.mega-product-img {
  width: 90px;
  height: 90px;
  border-radius: 14px;
  overflow: hidden;
  margin-bottom: 12px;
  background: #f8f9fa;
  position: relative;
}

.mega-product-img img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.5s ease;
}

.mega-product-card:hover .mega-product-img img {
  transform: scale(1.1);
}

.mega-product-hover-icon {
  position: absolute;
  inset: 0;
  background: rgba(102, 126, 234, 0.85);
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.mega-product-hover-icon i {
  color: #fff;
  font-size: 1.2rem;
}

.mega-product-card:hover .mega-product-hover-icon {
  opacity: 1;
}

.mega-product-placeholder {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #d1d5db;
  font-size: 2rem;
}

.mega-product-details {
  text-align: center;
}

.mega-product-name {
  display: block;
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--header-text);
  margin-bottom: 4px;
  line-height: 1.3;
}

.mega-product-price {
  font-size: 0.9rem;
  font-weight: 700;
  background: linear-gradient(135deg, var(--header-gradient-1), var(--header-gradient-2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* Promo Card */
.mega-promo-card {
  display: block;
  position: relative;
  width: 100%;
  height: 100%;
  min-height: 240px;
  border-radius: 18px;
  overflow: hidden;
  text-decoration: none;
}

.mega-promo-card img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.6s ease;
}

.mega-promo-card:hover img {
  transform: scale(1.08);
}

.mega-promo-content {
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, transparent 40%, rgba(0,0,0,0.75) 100%);
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  padding: 24px 18px;
}

.mega-promo-badge {
  display: inline-block;
  background: linear-gradient(135deg, var(--header-gradient-1), var(--header-gradient-2));
  color: #fff;
  font-size: 0.6rem;
  font-weight: 800;
  padding: 5px 12px;
  border-radius: 20px;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  margin-bottom: 10px;
  width: fit-content;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
}

.mega-promo-title {
  display: block;
  color: #fff;
  font-size: 1.1rem;
  font-weight: 700;
  margin-bottom: 8px;
  line-height: 1.2;
}

.mega-promo-cta {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  color: rgba(255, 255, 255, 0.9);
  font-size: 0.8rem;
  font-weight: 600;
  transition: all 0.3s ease;
}

.mega-promo-cta i {
  font-size: 0.7rem;
  transition: transform 0.3s ease;
}

.mega-promo-card:hover .mega-promo-cta {
  color: #fff;
}

.mega-promo-card:hover .mega-promo-cta i {
  transform: translateX(5px);
}

/* Header Actions */
.header-actions {
  display: flex;
  align-items: center;
  gap: 6px;
}

.action-btn {
  position: relative;
  width: 44px;
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  border-radius: 12px;
  color: var(--header-text);
  font-size: 1.15rem;
  cursor: pointer;
  transition: all 0.3s ease;
  text-decoration: none;
}

.action-btn:hover {
  background: rgba(102, 126, 234, 0.1);
  color: var(--header-gradient-1);
}

.action-badge {
  position: absolute;
  top: 4px;
  right: 4px;
  min-width: 18px;
  height: 18px;
  background: linear-gradient(135deg, var(--header-gradient-1) 0%, var(--header-gradient-2) 100%);
  color: #fff;
  font-size: 0.65rem;
  font-weight: 700;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Mobile Toggle */
.mobile-toggle {
  display: none;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 5px;
  width: 44px;
  height: 44px;
  background: transparent;
  border: none;
  cursor: pointer;
  padding: 10px;
}

.toggle-bar {
  width: 22px;
  height: 2px;
  background: var(--header-text);
  border-radius: 2px;
  transition: all 0.3s ease;
}

.mobile-toggle.active .toggle-bar:nth-child(1) {
  transform: rotate(45deg) translate(5px, 5px);
}

.mobile-toggle.active .toggle-bar:nth-child(2) {
  opacity: 0;
}

.mobile-toggle.active .toggle-bar:nth-child(3) {
  transform: rotate(-45deg) translate(5px, -5px);
}

/* Search Modal */
.search-modal {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: #fff;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
  padding: 30px 0;
  opacity: 0;
  visibility: hidden;
  transform: translateY(-10px);
  transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
  z-index: 100;
}

.search-modal.active {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
}

.search-modal-inner {
  max-width: 700px;
  margin: 0 auto;
  padding: 0 24px;
}

.search-input-wrapper {
  display: flex;
  align-items: center;
  gap: 16px;
  background: #f8f9fa;
  border-radius: 16px;
  padding: 16px 20px;
  border: 2px solid transparent;
  transition: all 0.3s ease;
}

.search-input-wrapper:focus-within {
  background: #fff;
  border-color: var(--header-gradient-1);
  box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
}

.search-input-wrapper > i {
  color: #adb5bd;
  font-size: 1.1rem;
}

.search-input {
  flex: 1;
  border: none;
  background: transparent;
  font-size: 1rem;
  color: var(--header-text);
  outline: none;
}

.search-input::placeholder {
  color: #adb5bd;
}

.search-close {
  width: 36px;
  height: 36px;
  border: none;
  background: #e9ecef;
  border-radius: 10px;
  color: #6c757d;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
}

.search-close:hover {
  background: #dee2e6;
  color: var(--header-text);
}

.search-suggestions {
  margin-top: 20px;
  text-align: center;
}

.suggestions-title {
  display: block;
  font-size: 0.75rem;
  font-weight: 600;
  color: #6c757d;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  margin-bottom: 12px;
}

.suggestions-tags {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 8px;
}

.suggestion-tag {
  padding: 8px 16px;
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
  color: var(--header-gradient-1);
  font-size: 0.85rem;
  font-weight: 500;
  border-radius: 25px;
  text-decoration: none;
  transition: all 0.3s ease;
}

.suggestion-tag:hover {
  background: linear-gradient(135deg, var(--header-gradient-1) 0%, var(--header-gradient-2) 100%);
  color: #fff;
}

/* ============================================
   MOBILE MENU - FULL FEATURED
   ============================================ */
.mobile-menu {
  position: fixed;
  top: 0;
  left: -100%;
  width: 340px;
  max-width: 90%;
  height: 100vh;
  background: #fff;
  z-index: 2000;
  display: flex;
  flex-direction: column;
  transition: left 0.4s cubic-bezier(0.23, 1, 0.32, 1);
  box-shadow: 10px 0 50px rgba(0, 0, 0, 0.15);
}

.mobile-menu.active {
  left: 0;
}

.mobile-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(3px);
  z-index: 1999;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
}

.mobile-overlay.active {
  opacity: 1;
  visibility: visible;
}

.mobile-menu-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 20px 24px;
  border-bottom: 1px solid #f0f0f5;
}

.mobile-logo img {
  height: 36px;
  width: auto;
}

.mobile-logo span {
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--header-text);
}

.mobile-close {
  width: 42px;
  height: 42px;
  border: none;
  background: #f8f9fa;
  border-radius: 12px;
  color: var(--header-text);
  font-size: 1.1rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
}

.mobile-close:hover {
  background: var(--header-gradient-1);
  color: #fff;
}

.mobile-menu-body {
  flex: 1;
  overflow-y: auto;
  padding: 16px 0;
}

.mobile-nav {
  list-style: none;
  margin: 0;
  padding: 0;
}

.mobile-nav-item {
  border-bottom: 1px solid #f0f0f5;
}

.mobile-nav-row {
  display: flex;
  align-items: center;
}

.mobile-nav-link {
  flex: 1;
  display: flex;
  align-items: center;
  padding: 18px 24px;
  color: var(--header-text);
  font-size: 1rem;
  font-weight: 600;
  text-decoration: none;
  transition: all 0.3s ease;
}

.mobile-nav-link:hover {
  color: var(--header-gradient-1);
  background: rgba(102, 126, 234, 0.04);
}

.mobile-toggle-child {
  width: 50px;
  height: 56px;
  border: none;
  background: transparent;
  color: var(--header-text-light);
  font-size: 0.85rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
}

.mobile-toggle-child:hover {
  color: var(--header-gradient-1);
}

.mobile-nav-item.open .mobile-toggle-child i {
  transform: rotate(45deg);
}

.mobile-toggle-child i {
  transition: transform 0.3s ease;
}

/* Mobile Subnav */
.mobile-subnav {
  display: none;
  background: #f8f9fa;
  padding: 12px 0;
}

.mobile-nav-item.open .mobile-subnav {
  display: block;
}

.mobile-subnav-link {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 12px 24px 12px 36px;
  color: var(--header-text-light);
  font-size: 0.9rem;
  font-weight: 500;
  text-decoration: none;
  transition: all 0.3s ease;
}

.mobile-subnav-link:hover {
  color: var(--header-gradient-1);
  background: rgba(102, 126, 234, 0.06);
}

.mobile-subnav-dot {
  width: 5px;
  height: 5px;
  background: #d1d5db;
  border-radius: 50%;
  transition: all 0.3s ease;
}

.mobile-subnav-link:hover .mobile-subnav-dot {
  background: var(--header-gradient-1);
}

/* Mobile Featured Section */
.mobile-featured-section {
  padding: 16px 24px;
  background: #fff;
  margin: 8px 16px;
  border-radius: 16px;
  border: 1px solid var(--header-border);
}

.mobile-featured-title {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.75rem;
  font-weight: 700;
  color: var(--header-gradient-1);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin-bottom: 14px;
}

.mobile-featured-title i {
  font-size: 0.8rem;
}

.mobile-featured-products {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.mobile-featured-product {
  display: flex;
  align-items: center;
  gap: 14px;
  padding: 10px;
  background: #f8f9fa;
  border-radius: 12px;
  text-decoration: none;
  transition: all 0.3s ease;
}

.mobile-featured-product:hover {
  background: rgba(102, 126, 234, 0.08);
  transform: translateX(4px);
}

.mobile-featured-product img {
  width: 55px;
  height: 55px;
  border-radius: 10px;
  object-fit: cover;
}

.mobile-featured-info {
  flex: 1;
}

.mobile-featured-name {
  display: block;
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--header-text);
  margin-bottom: 2px;
}

.mobile-featured-price {
  font-size: 0.85rem;
  font-weight: 700;
  color: var(--header-gradient-1);
}

/* Mobile Promo Banner */
.mobile-promo-banner {
  display: block;
  margin: 12px 16px;
  border-radius: 16px;
  overflow: hidden;
  position: relative;
  height: 120px;
}

.mobile-promo-banner img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.mobile-promo-overlay {
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, transparent 30%, rgba(0,0,0,0.7) 100%);
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  padding: 16px;
}

.mobile-promo-badge {
  display: inline-block;
  background: linear-gradient(135deg, var(--header-gradient-1), var(--header-gradient-2));
  color: #fff;
  font-size: 0.55rem;
  font-weight: 800;
  padding: 4px 10px;
  border-radius: 15px;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  width: fit-content;
  margin-bottom: 6px;
}

.mobile-promo-title {
  color: #fff;
  font-size: 0.95rem;
  font-weight: 700;
}

/* Mobile Menu Footer */
.mobile-menu-footer {
  padding: 20px 24px;
  border-top: 1px solid #f0f0f5;
  background: #f8f9fa;
}

.mobile-actions {
  display: flex;
  gap: 10px;
  margin-bottom: 18px;
}

.mobile-action {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  padding: 14px 10px;
  background: #fff;
  border-radius: 14px;
  text-decoration: none;
  color: var(--header-text);
  font-size: 0.75rem;
  font-weight: 500;
  transition: all 0.3s ease;
  border: 1px solid transparent;
}

.mobile-action i {
  font-size: 1.15rem;
  color: var(--header-gradient-1);
}

.mobile-action:hover {
  border-color: var(--header-gradient-1);
  background: rgba(102, 126, 234, 0.05);
}

.mobile-social {
  display: flex;
  justify-content: center;
  gap: 12px;
}

.mobile-social a {
  width: 42px;
  height: 42px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #fff;
  border-radius: 12px;
  color: var(--header-text-light);
  font-size: 1rem;
  text-decoration: none;
  transition: all 0.3s ease;
}

.mobile-social a:hover {
  background: linear-gradient(135deg, var(--header-gradient-1) 0%, var(--header-gradient-2) 100%);
  color: #fff;
  transform: translateY(-2px);
}

/* ============================================
   RESPONSIVE
   ============================================ */
@media (max-width: 1024px) {
  .header-nav {
    display: none;
  }
  
  .mobile-toggle {
    display: flex;
  }
  
  .header-inner {
    gap: 16px;
  }
}

@media (max-width: 768px) {
  .header-inner {
    height: 65px;
    gap: 12px;
    padding: 0 16px;
  }
  
  .main-header .container {
    padding: 0;
  }
  
  .logo-img {
    height: 32px;
  }
  
  .logo-text {
    font-size: 1.25rem;
  }
  
  .header-actions {
    gap: 2px;
  }
  
  .action-btn {
    width: 38px;
    height: 38px;
    font-size: 0.95rem;
    border-radius: 10px;
  }
  
  .action-badge {
    min-width: 16px;
    height: 16px;
    font-size: 0.6rem;
    top: 2px;
    right: 2px;
  }
  
  .mobile-toggle {
    width: 38px;
    height: 38px;
    gap: 4px;
    padding: 8px;
  }
  
  .toggle-bar {
    width: 18px;
    height: 2px;
  }
  
  .announcement-bar {
    padding: 8px 0;
  }
  
  .announcement-item {
    font-size: 0.75rem;
    gap: 6px;
  }
  
  .announcement-item i {
    font-size: 0.85rem;
  }
  
  .announcement-item a {
    margin-left: 4px;
  }
  
  /* Search Modal Mobile - Full Screen */
  .search-modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    padding: 20px 0;
    z-index: 2000;
  }
  
  .search-modal-inner {
    padding: 0 16px;
    height: 100%;
    display: flex;
    flex-direction: column;
  }
  
  .search-input-wrapper {
    padding: 12px 16px;
    gap: 12px;
    border-radius: 12px;
  }
  
  .search-input {
    font-size: 0.9rem;
  }
  
  .search-close {
    width: 32px;
    height: 32px;
    border-radius: 8px;
  }
  
  .suggestions-tags {
    gap: 6px;
  }
  
  .suggestion-tag {
    padding: 6px 12px;
    font-size: 0.8rem;
  }
}

@media (max-width: 480px) {
  .header-inner {
    height: 60px;
    gap: 8px;
  }
  
  .logo-img {
    height: 28px;
  }
  
  .logo-text {
    font-size: 1.1rem;
  }
  
  .action-btn {
    width: 36px;
    height: 36px;
    font-size: 0.9rem;
  }
  
  /* Hide some icons on very small screens */
  .wishlist-btn {
    display: none;
  }
  
  .mobile-menu {
    width: 100%;
    max-width: 100%;
  }
  
  .announcement-item {
    font-size: 0.7rem;
  }
  
  .announcement-item a {
    display: none;
  }
}

@media (max-width: 360px) {
  .header-inner {
    height: 56px;
    gap: 6px;
  }
  
  .logo-img {
    height: 24px;
  }
  
  .action-btn {
    width: 32px;
    height: 32px;
    font-size: 0.85rem;
  }
  
  .account-btn {
    display: none;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   STACKED LAYOUT (MODE 2) STYLES
   ═══════════════════════════════════════════════════════════════════════════ */
.header-layout-stacked .header-top-row {
  background: var(--header-bg);
  border-bottom: 1px solid var(--header-border);
  padding: 16px 0;
}

.header-layout-stacked .header-top-inner {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 24px;
}

/* Logo Stacked */
.header-logo-stacked {
  display: flex;
  align-items: center;
  text-decoration: none;
  flex-shrink: 0;
}

.header-logo-stacked .logo-img {
  height: 50px;
  width: auto;
  object-fit: contain;
}

.header-logo-stacked .logo-text {
  font-size: 1.6rem;
  font-weight: 700;
  background: linear-gradient(135deg, var(--header-gradient-1), var(--header-gradient-2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* Stacked Search */
.header-search-stacked {
  flex: 1;
  max-width: 600px;
}

.stacked-search-form {
  width: 100%;
}

.stacked-search-wrapper {
  display: flex;
  align-items: center;
  background: #f8f9fc;
  border: 2px solid transparent;
  border-radius: 50px;
  padding: 4px 4px 4px 20px;
  transition: all 0.3s ease;
}

.stacked-search-wrapper:focus-within {
  border-color: var(--header-gradient-1);
  background: #fff;
  box-shadow: 0 4px 20px rgba(102, 126, 234, 0.15);
}

.stacked-search-icon {
  color: var(--header-text-light);
  font-size: 1rem;
  margin-right: 12px;
}

.stacked-search-input {
  flex: 1;
  border: none;
  background: transparent;
  font-size: 0.95rem;
  color: var(--header-text);
  outline: none;
  padding: 10px 0;
}

.stacked-search-input::placeholder {
  color: #9ca3af;
}

.stacked-search-btn {
  background: linear-gradient(135deg, var(--header-gradient-1), var(--header-gradient-2));
  color: #fff;
  border: none;
  padding: 12px 28px;
  border-radius: 50px;
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
}

.stacked-search-btn:hover {
  transform: scale(1.02);
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
}

/* Stacked Actions */
.header-actions-stacked {
  display: flex;
  align-items: center;
  gap: 8px;
}

.stacked-action-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  padding: 8px 16px;
  text-decoration: none;
  color: var(--header-text);
  border-radius: 12px;
  transition: all 0.3s ease;
  position: relative;
}

.stacked-action-btn:hover {
  background: rgba(102, 126, 234, 0.08);
  color: var(--header-gradient-1);
}

.stacked-action-btn i {
  font-size: 1.25rem;
}

.stacked-action-label {
  font-size: 0.7rem;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.03em;
}

.stacked-action-badge {
  position: absolute;
  top: 2px;
  right: 8px;
  min-width: 18px;
  height: 18px;
  background: linear-gradient(135deg, #ef4444, #dc2626);
  color: #fff;
  font-size: 0.65rem;
  font-weight: 700;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.stacked-action-badge:empty,
.stacked-action-badge[data-count="0"] {
  display: none;
}

/* Bottom Row - Navigation */
.header-layout-stacked .header-bottom-row {
  background: var(--header-bg);
  border-bottom: 1px solid var(--header-border);
  position: relative;
}

.header-layout-stacked .header-bottom-row .container {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-nav-stacked {
  display: flex;
  align-items: center;
  justify-content: center;
}

.nav-menu-stacked {
  display: flex;
  align-items: center;
  gap: 8px;
  list-style: none;
  margin: 0;
  padding: 0;
}

.nav-menu-stacked .nav-link {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 16px 20px;
  color: var(--header-text);
  text-decoration: none;
  font-size: 0.9rem;
  font-weight: 600;
  transition: all 0.3s ease;
}

.nav-menu-stacked .nav-link:hover,
.nav-menu-stacked .nav-link.active {
  color: var(--header-gradient-1);
}

.mobile-toggle-stacked {
  display: none;
  order: -1; /* Show first in mobile */
}

/* Stacked Layout Responsive */
@media (max-width: 1024px) {
  .header-layout-stacked .header-search-stacked {
    display: none;
  }
  
  .header-layout-stacked .header-bottom-row {
    display: none;
  }
  
  .mobile-toggle-stacked {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 5px;
    width: 44px;
    height: 44px;
    background: transparent;
    border: none;
    cursor: pointer;
    padding: 10px;
  }
  
  .mobile-toggle-stacked .toggle-bar {
    width: 22px;
    height: 2px;
    background: var(--header-text);
    border-radius: 2px;
    transition: all 0.3s ease;
  }
  
  /* Hamburger animation when active */
  .mobile-toggle-stacked.active .toggle-bar:nth-child(1) {
    transform: rotate(45deg) translate(5px, 5px);
  }
  .mobile-toggle-stacked.active .toggle-bar:nth-child(2) {
    opacity: 0;
  }
  .mobile-toggle-stacked.active .toggle-bar:nth-child(3) {
    transform: rotate(-45deg) translate(5px, -5px);
  }
  
  .header-layout-stacked .stacked-action-label {
    display: none;
  }
  
  .stacked-action-btn {
    padding: 8px;
  }
}

@media (max-width: 768px) {
  .header-layout-stacked .header-top-inner {
    gap: 12px;
  }
  
  .header-logo-stacked .logo-img {
    height: 38px;
  }
  
  .stacked-action-btn i {
    font-size: 1.1rem;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // ============================================
  // MOBILE MENU
  // ============================================
  const mobileToggle = document.getElementById('mobileToggle');
  const mobileToggleStacked = document.getElementById('mobileToggleStacked');
  const mobileClose = document.getElementById('mobileClose');
  const mobileMenu = document.getElementById('mobileMenu');
  const mobileOverlay = document.getElementById('mobileOverlay');
  
  function openMobileMenu() {
    mobileMenu?.classList.add('active');
    mobileOverlay?.classList.add('active');
    document.body.style.overflow = 'hidden';
    mobileToggle?.classList.add('active');
    mobileToggleStacked?.classList.add('active');
  }
  
  function closeMobileMenu() {
    mobileMenu?.classList.remove('active');
    mobileOverlay?.classList.remove('active');
    document.body.style.overflow = '';
    mobileToggle?.classList.remove('active');
    mobileToggleStacked?.classList.remove('active');
  }
  
  mobileToggle?.addEventListener('click', openMobileMenu);
  mobileToggleStacked?.addEventListener('click', openMobileMenu);
  mobileClose?.addEventListener('click', closeMobileMenu);
  mobileOverlay?.addEventListener('click', closeMobileMenu);
  
  // Mobile Subnav Toggle
  document.querySelectorAll('.mobile-toggle-child').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      e.stopPropagation();
      const item = btn.closest('.mobile-nav-item');
      
      // Close other open items
      document.querySelectorAll('.mobile-nav-item.open').forEach(openItem => {
        if (openItem !== item) {
          openItem.classList.remove('open');
        }
      });
      
      item.classList.toggle('open');
    });
  });
  
  // ============================================
  // SEARCH MODAL
  // ============================================
  const searchTrigger = document.getElementById('searchTrigger');
  const searchModal = document.getElementById('searchModal');
  const searchClose = document.getElementById('searchClose');
  const searchInput = document.getElementById('searchInput');
  
  searchTrigger?.addEventListener('click', () => {
    searchModal?.classList.add('active');
    setTimeout(() => searchInput?.focus(), 150);
  });
  
  searchClose?.addEventListener('click', () => {
    searchModal?.classList.remove('active');
  });
  
  // Close search on outside click
  document.addEventListener('click', (e) => {
    if (searchModal?.classList.contains('active') && 
        !searchModal.contains(e.target) && 
        !searchTrigger?.contains(e.target)) {
      searchModal.classList.remove('active');
    }
  });
  
  // Close search on Escape
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && searchModal?.classList.contains('active')) {
      searchModal.classList.remove('active');
    }
  });
  
  // ============================================
  // STICKY HEADER SHADOW
  // ============================================
  const header = document.getElementById('mainHeader');
  let lastScroll = 0;
  
  window.addEventListener('scroll', () => {
    const currentScroll = window.scrollY;
    
    if (currentScroll > 50) {
      header?.classList.add('scrolled');
    } else {
      header?.classList.remove('scrolled');
    }
    
    lastScroll = currentScroll;
  }, { passive: true });
  
  // ============================================
  // MEGA MENU - DESKTOP (Touch/Click Support)
  // ============================================
  const navItems = document.querySelectorAll('.nav-item.has-mega');
  
  // Detect touch device
  const isTouchDevice = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0);
  
  // Desktop: Hover behavior with delay (only for non-touch devices)
  if (!isTouchDevice) {
    navItems.forEach(item => {
      let hoverTimeout;
      
      item.addEventListener('mouseenter', () => {
        clearTimeout(hoverTimeout);
        // Close other mega menus
        navItems.forEach(other => {
          if (other !== item) other.classList.remove('mega-active');
        });
        item.classList.add('mega-active');
      });
      
      item.addEventListener('mouseleave', () => {
        hoverTimeout = setTimeout(() => {
          item.classList.remove('mega-active');
        }, 150);
      });
    });
  }
  
  // Touch/Click support for tablets AND touch devices
  navItems.forEach(item => {
    const navLink = item.querySelector('.nav-link');
    navLink?.addEventListener('click', (e) => {
      // On mobile (hamburger menu visible), don't handle here
      if (window.innerWidth <= 1024 && document.querySelector('.mobile-menu')) {
        // Check if mobile menu is the active navigation method
        const mobileToggle = document.querySelector('.mobile-toggle, .mobile-toggle-stacked');
        if (mobileToggle && window.getComputedStyle(mobileToggle).display !== 'none') {
          return; // Let mobile menu handle it
        }
      }
      
      // For touch devices or when mega menu should toggle
      if (isTouchDevice || window.innerWidth <= 1200) {
        if (item.classList.contains('mega-active')) {
          // If already open, navigate to link
          return;
        } else {
          // Prevent navigation, open mega menu
          e.preventDefault();
          navItems.forEach(other => other.classList.remove('mega-active'));
          item.classList.add('mega-active');
        }
      }
    });
  });
  
  // Close mega menu when clicking outside
  document.addEventListener('click', (e) => {
    if (!e.target.closest('.nav-item.has-mega')) {
      navItems.forEach(item => item.classList.remove('mega-active'));
    }
  });
  
  // Close mega menu on Escape
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      navItems.forEach(item => item.classList.remove('mega-active'));
    }
  });
  
  // ============================================
  // MEGA MENU TABS - Submenu Hover/Click
  // ============================================
  document.querySelectorAll('.mega-tab-item').forEach(tab => {
    const hasProducts = tab.dataset.hasProducts === 'true';
    
    const handleTabActivation = () => {
      // Only activate panel if this menu has products
      if (!hasProducts) return;
      
      const tabId = tab.dataset.tab;
      const parentId = tab.dataset.parent;
      const megaDropdown = tab.closest('.mega-dropdown');
      
      if (!megaDropdown) return;
      
      // Remove active from all tabs in this menu
      megaDropdown.querySelectorAll('.mega-tab-item').forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      
      // Show corresponding panel
      megaDropdown.querySelectorAll('.mega-products-panel').forEach(panel => {
        panel.classList.remove('active');
        if (panel.dataset.panel === tabId && panel.dataset.parent === parentId) {
          panel.classList.add('active');
        }
      });
    };
    
    // Hover for desktop - only show panel if has products
    tab.addEventListener('mouseenter', handleTabActivation);
    
    // Click - navigate to link if no products, otherwise show panel
    tab.addEventListener('click', (e) => {
      if (hasProducts) {
        // Has products: prevent default on click, panel will show on hover
        // Let the link work on second click or direct click
        const href = tab.getAttribute('href');
        if (href && href !== '#') {
          // Allow navigation - don't prevent default
          return;
        }
      }
      // No products or no href: let link work naturally
    });
  });
  
  // ============================================
  // CART COUNT ANIMATION
  // ============================================
  const cartBadge = document.querySelector('.cart-count');
  if (cartBadge) {
    const count = parseInt(cartBadge.textContent) || 0;
    if (count === 0) {
      cartBadge.style.display = 'none';
    }
  }
  
  // ============================================
  // ACCESSIBILITY: Skip to content
  // ============================================
  const skipLink = document.querySelector('.skip-to-content');
  skipLink?.addEventListener('click', (e) => {
    e.preventDefault();
    const main = document.querySelector('main') || document.querySelector('[role="main"]');
    if (main) {
      main.setAttribute('tabindex', '-1');
      main.focus();
    }
  });
});
</script>

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "header",
      "content": "📐 Layout Mode"
    },
    {
      "type": "select",
      "id": "header_layout",
      "label": "Header Layout",
      "options": [
        { "value": "default", "label": "Default (Single Row)" },
        { "value": "stacked", "label": "Stacked (Logo + Search + Menu)" }
      ],
      "default": "default",
      "info": "Stacked: Top row with logo, search, actions. Bottom row with menu."
    },
    {
      "type": "text",
      "id": "search_placeholder",
      "label": "Search Placeholder",
      "default": "Search products..."
    },
    {
      "type": "header",
      "content": "Logo"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo Image"
    },
    {
      "type": "header",
      "content": "Navigation"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Main Menu",
      "default": "main-menu"
    },
    {
      "type": "image_picker",
      "id": "dropdown_image",
      "label": "Default Dropdown Promo Image"
    },
    {
      "type": "header",
      "content": "Announcement Bar"
    },
    {
      "type": "checkbox",
      "id": "show_announcement",
      "label": "Show Announcement Bar",
      "default": true
    },
    {
      "type": "text",
      "id": "announcement_icon",
      "label": "Icon Class",
      "default": "fa-solid fa-truck-fast"
    },
    {
      "type": "text",
      "id": "announcement_text",
      "label": "Announcement Text",
      "default": "Free shipping on orders over $50!"
    },
    {
      "type": "text",
      "id": "announcement_link_text",
      "label": "Link Text",
      "default": "Shop Now"
    },
    {
      "type": "url",
      "id": "announcement_link",
      "label": "Link URL"
    },
    {
      "type": "header",
      "content": "Features"
    },
    {
      "type": "checkbox",
      "id": "sticky_header",
      "label": "Sticky Header",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_account",
      "label": "Show Account Icon",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_wishlist",
      "label": "Show Wishlist Icon",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_social_mobile",
      "label": "Show Social in Mobile Menu",
      "default": true
    },
    {
      "type": "header",
      "content": "Social Links"
    },
    {
      "type": "url",
      "id": "facebook",
      "label": "Facebook URL"
    },
    {
      "type": "url",
      "id": "instagram",
      "label": "Instagram URL"
    },
    {
      "type": "url",
      "id": "twitter",
      "label": "Twitter/X URL"
    },
    {
      "type": "url",
      "id": "tiktok",
      "label": "TikTok URL"
    }
  ],
  "blocks": [
    {
      "type": "mega_menu",
      "name": "Mega Menu (Main)",
      "settings": [
        {
          "type": "text",
          "id": "menu_title",
          "label": "Main Menu Item Title",
          "info": "Enter the exact title of the MAIN menu item (e.g., 'Special DTF', 'Products')"
        },
        {
          "type": "header",
          "content": "Promo Banner"
        },
        {
          "type": "image_picker",
          "id": "promo_image",
          "label": "Promo Image"
        },
        {
          "type": "text",
          "id": "promo_badge",
          "label": "Promo Badge Text",
          "default": "NEW"
        },
        {
          "type": "text",
          "id": "promo_title",
          "label": "Promo Title",
          "default": "New Arrivals"
        },
        {
          "type": "url",
          "id": "promo_link",
          "label": "Promo Link"
        }
      ]
    },
    {
      "type": "submenu_item",
      "name": "Submenu Products",
      "settings": [
        {
          "type": "paragraph",
          "content": "Assign products to a SUBMENU item (child link). The products will appear when user hovers over the submenu tab."
        },
        {
          "type": "text",
          "id": "parent_menu",
          "label": "Parent Menu Title",
          "info": "Exact title of the MAIN menu (e.g., 'Special DTF')"
        },
        {
          "type": "text",
          "id": "submenu_title",
          "label": "Submenu Item Title",
          "info": "Exact title of the SUBMENU item (e.g., 'Glitter DTF')"
        },
        {
          "type": "header",
          "content": "Products (up to 5)"
        },
        {
          "type": "product",
          "id": "product_1",
          "label": "Product 1"
        },
        {
          "type": "product",
          "id": "product_2",
          "label": "Product 2"
        },
        {
          "type": "product",
          "id": "product_3",
          "label": "Product 3"
        },
        {
          "type": "product",
          "id": "product_4",
          "label": "Product 4"
        },
        {
          "type": "product",
          "id": "product_5",
          "label": "Product 5"
        }
      ]
    }
  ]
}
{% endschema %}






